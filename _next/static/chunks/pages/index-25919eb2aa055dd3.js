(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{3077:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(1524)}])},2244:function(e,t,i){"use strict";i.d(t,{Z:function(){return f}});var n=i(3863),r=i(8063),c=i(6999);let o=(0,r.Ue)()((0,c.tJ)(e=>({activeIdentityID:null,identities:[],setActiveIdentityID:t=>e({activeIdentityID:t}),insertIdentity:t=>e(e=>({identities:[t,...e.identities]})),replaceIdentity:t=>e(e=>({identities:e.identities.map(e=>e.id===t.id?t:e)})),reset:()=>e(()=>({identities:[],activeIdentity:null,activeIdentityID:null,lastIdentityNonce:0}))}),{name:"Simulator_Identity_Store_2"}));var l=i(8928),a=i(6457),s=i(959),u=i(5075);let d=e=>({activeIdentityID:e.activeIdentityID,identities:e.identities,setActiveIdentityID:e.setActiveIdentityID,insertIdentity:e.insertIdentity,replaceIdentity:e.replaceIdentity,reset:e.reset});var f=()=>{let{activeIdentityID:e,identities:t,setActiveIdentityID:i,insertIdentity:r,replaceIdentity:c,reset:f}=o(d),y=(0,s.useCallback)(async e=>{if(e.proofGenerationTime&&e.proofGenerationTime>Date.now()-18e5)return e;let{commitment:t}=new l.i(e.zkIdentity),i=(0,n.cv)(t),r=i.slice(0,10),o=await h(a.fZ.Orb,i),s=await h(a.fZ.Device,i),u={...e,id:r,verified:{[a.fZ.Orb]:null!==o,[a.fZ.Device]:null!==s},inclusionProof:{[a.fZ.Orb]:o,[a.fZ.Device]:s},proofGenerationTime:Date.now()};return c(u),u},[c]),I=(0,s.useCallback)(async e=>{let o=e||0==e?e:t.length;if(o>999){u.Am.error("You have reached the maximum number of identities");return}let s=new l.i(o.toString()),d={id:(0,n.cv)(s.commitment).slice(0,10),meta:{name:"Identity #".concat(o),idNumber:o},zkIdentity:s.toString(),verified:{[a.fZ.Orb]:!0,[a.fZ.Device]:!0},inclusionProof:{[a.fZ.Orb]:null,[a.fZ.Device]:null},proofGenerationTime:null};return r(d),i(d.id),await y(d).then(e=>(c(e),e))},[t.length,r,c,i,y]),v=(0,s.useCallback)(async()=>{for(let e=0;e<5;e++)I(e)},[I]),m=(0,s.useCallback)(()=>{f(),v()},[v,f]),p=(0,s.useMemo)(()=>{var i;return e&&"undefined"!==e&&null!==(i=t.find(t=>t.id===e))&&void 0!==i?i:null},[e,t]),h=async(e,t)=>{try{let i=await fetch("/api/sequencer/inclusionProof",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({verificationLevel:e,commitment:t})});if(200===i.status)return console.log("Fetched fresh inclusion proof from sequencer for: ".concat(e,".")),await i.json()}catch(t){console.error("Unable to get identity proof for credential type '".concat(e,"'. Error: ").concat(t))}return null};return{activeIdentityID:"undefined"!==e&&e?e:null,generateNextIdentity:I,identities:t,activeIdentity:p,resetIdentityStore:m,generateIdentityProofsIfNeeded:y,setActiveIdentityID:i,generateFirstFiveIdentities:v}}},1524:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return l}});var n=i(1527),r=i(2244),c=i(234),o=i(959);function l(){let e=(0,c.useRouter)(),{activeIdentityID:t,identities:i,generateFirstFiveIdentities:l}=(0,r.Z)();return(0,o.useEffect)(()=>{0===i.length&&(console.log("Generating first five identities..."),l())},[l,i]),(0,o.useEffect)(()=>{null==t||e.pathname.includes("/id/".concat(t))?t||e.pathname.includes("/select-id")||(console.log("Redirecting to select identity"),e.push("/select-id")):(console.log("Redirecting to active identity:",t),e.push("/id/".concat(t)))},[t,e]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{})})}},234:function(e,t,i){e.exports=i(177)},9391:function(){}},function(e){e.O(0,[172,888,774,179],function(){return e(e.s=3077)}),_N_E=e.O()}]);